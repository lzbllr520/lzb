Ôr@Ÿªassertions¤code´customTransformCache¬dependencies¢id¤meta±moduleSideEffects¬originalCode±originalSourcemap«resolvedIds®sourcemapChainµsyntheticNamedExportsµtransformDependencies®transformFiles¨cacheAstÔrAÚ"é/*
 * The MIT License (MIT)
 * Copyright (C) 2023 Huawei Device Co., Ltd.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */

import http from './http.js'
import download from './download.js'
import upload from './upload.js'
import fs from '@ohos.file.fs';
import utils from '../../utils';
import buffer from '@ohos.buffer';
import _http from '@ohos.net.http';
import FormData from '../../env/classes/FormData.js'
import AxiosError from '../../../lib/core/AxiosError'
import buildFullPath from '../../../lib/core/buildFullPath';

const isXHRAdapterSupported = true
const part = '/data/storage/';

export default isXHRAdapterSupported && function (config) {
    return new Promise(function (resolve, reject) {
        const httpConfig = setHttpConfig(config, reject);
        if (config.data && config.data instanceof FormData && (config.method.toUpperCase() === 'POST' || config.method.toUpperCase() === 'PUT')) {
            // ä¸Šä¼ 
            upload(httpConfig, resolve, reject);
        } else if (config.filePath) {
            // ä¸‹è½½ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›é”™è¯¯ã€‚
            try {
                let path = '';
                let cacheDir = '';
                let filePath = config.filePath;
                if(config.context) {
                    cacheDir = config.context.cacheDir;
                    path = config.filePath.indexOf(cacheDir) > -1 ?  filePath : `${cacheDir}/${filePath}`;
                } else {
                    if(filePath.indexOf(part)===-1) {
                        return reject(new AxiosError('If there is no context, the filePath must be a complete fd path!', AxiosError.ERR_BAD_OPTION, null, null, null));
                    }
                }
                let res = fs.accessSync(path);
                if(!res){
                    download(httpConfig, resolve, reject);
                }else {
                    reject(new AxiosError('The file already exist, please delete the file first!', AxiosError.ERR_BAD_OPTION, null, null, null));
                }
            } catch (err) {
                reject(new AxiosError(err, AxiosError.ERR_BAD_OPTION, null, null, null));
            }
        } else {
            // å‘é€è¯·æ±‚
            http(httpConfig, resolve, reject);
        }
    })
}
/**
 * @param data éœ€è¦è®¡ç®—å­—èŠ‚çš„æ•°æ®
 */
const calculateLength = (data) => {
    let len = 0;
    if (data) {
        if (typeof data === 'string') {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥è®¡ç®—é•¿åº¦
            len = buffer.byteLength(data, 'utf8');
        } else if (buffer.isBuffer(data)) {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯Bufferå¯¹è±¡ï¼Œç›´æ¥è·å–é•¿åº¦
            len = data.length;
        } else if (data instanceof ArrayBuffer) {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯ArrayBufferå¯¹è±¡ï¼Œç›´æ¥è·å–é•¿åº¦
            len = data.byteLength;
        } else if (typeof data === 'number') {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯numberï¼Œç›´æ¥èµ‹å€¼
            len = data;
        }else {
            // å¯¹è±¡
            let tmp = data;
            if (utils.isFormData(data)) {
                function formDataToObject(formData) {
                    let object = {};
                    formData.forEach(function (value, key) {
                        object[key] = value;
                    });
                    return object;
                }
                tmp = formDataToObject(data);
            }
            // å¦‚æœè¯·æ±‚ä½“æ˜¯å¯¹è±¡ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²åè®¡ç®—é•¿åº¦
            len = buffer.byteLength(JSON.stringify(tmp), 'utf8');
        }
    }
    return len;
}
/**
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 */
const judgeMaxBodyLength = (config, reject) => {
    // è®¡ç®—è¯·æ±‚ä½“å¤§å°
    let requestBodyLength = calculateLength(config.data);
    if (config.maxBodyLength > -1 && requestBodyLength > config.maxBodyLength) {
        return reject(new AxiosError('Request body larger than maxBodyLength limit', AxiosError.ERR_BAD_REQUEST, config));
    }
}
/**
 * @param data å“åº”æ•°æ®
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 * @param lastRequest è¯·æ±‚å®ä¾‹
 * @param handle æ ¡éªŒåå›è°ƒ
 */
const judgeMaxContentLength = (data, config, reject, lastRequest, handle) => {
    // è®¡ç®—å“åº”å¤§å°
    let maxContentLength = calculateLength(data);
    let valid = true;
    if (config.maxContentLength > -1 && maxContentLength > config.maxContentLength) {
        valid = false;
    }
    handle&&handle(valid);
    // è¿”å›å†…å®¹å¤§äºconfig.maxContentLengthæŠ›å‡ºå¼‚å¸¸
    if(!valid) {
        return reject(new AxiosError(
            'maxContentLength size of ' + config.maxContentLength + ' exceeded',
            AxiosError.ERR_BAD_RESPONSE,
            config,
            lastRequest
        ));
    }
}
/**åˆ›å»ºè¯·æ±‚ä»»åŠ¡
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 */
const setHttpConfig = (config, reject) => {
    // æ¯ä¸€ä¸ªhttpRequestå¯¹åº”ä¸€ä¸ªhttpè¯·æ±‚ä»»åŠ¡ï¼Œä¸å¯å¤ç”¨
    let httpRequest = _http.createHttp();
    let fullPath = buildFullPath(config.baseURL, config.url);
    // urlæ ¡éªŒ
    if (!fullPath) {
        return reject(new AxiosError("Cannot read properties of url!", AxiosError.ERR_BAD_OPTION, config, null, null));
    } else if (typeof (fullPath) !== 'string') {
        return reject(new AxiosError("Url type should be character typeï¼", AxiosError.ERR_BAD_OPTION_VALUE, config, null, null));
    }
    // åˆ¤æ–­è®¾ç½®çš„è¯·æ±‚ä½“çš„å¤§å°
    judgeMaxBodyLength(config, reject);
    return {
        httpRequest,
        fullPath,
        config
    }
}
/**è®¾ç½®è¯·æ±‚è‡ªå®šä¹‰é…ç½®é¡¹
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param handle å¤„ç†optionsçš„å‡½æ•°
 */
const setOptions = (config, handle) => {
    let options = {
        method: config.method.toUpperCase(),
        header: config.headers, // å¼€å‘è€…æ ¹æ®è‡ªèº«ä¸šåŠ¡éœ€è¦æ·»åŠ headerå­—æ®µ
        readTimeout: 0,
        maxLimit: -1// é»˜è®¤æ”¾å¼€http requestçš„5MBé™åˆ¶ï¼Œåœ¨axioså±‚çš„maxBodyLengthè¿›è¡Œé•¿åº¦é™åˆ¶
    }
    handle && handle(options)
    // è®¾ç½®è¯·æ±‚ä½“
    if (!utils.isUndefined(config.data)) { // å½“ä½¿ç”¨POSTè¯·æ±‚æ—¶æ­¤å­—æ®µç”¨äºä¼ é€’å†…å®¹
        options.extraData = config.data;
    }
    // è®¾ç½®è¿æ¥è¶…æ—¶
    if (utils.isNumber(config.connectTimeout)) {
        options.connectTimeout = config.connectTimeout;
    }
    // è®¾ç½®è¯»å–è¶…æ—¶
    if (utils.isNumber(config.timeout)) {
        options.readTimeout = config.timeout;
    }
    // è®¾ç½®è¯»å–è¶…æ—¶
    if (utils.isNumber(config.readTimeout)) {
        options.readTimeout = config.readTimeout;
    }
    // è®¾ç½®å“åº”æ¶ˆæ¯çš„æœ€å¤§å­—èŠ‚
    if (utils.isNumber(config.maxContentLength)) {
        options.maxLimit = config.maxContentLength;
    }
    // è®¾ç½®responseType
    if (!utils.isUndefined(config.responseType)) {
        let responseType = config.responseType.toUpperCase()
        switch (responseType) {
            case 'STRING':
                options.expectDataType = 0
                break;
            case 'OBJECT':
                options.expectDataType = 1
                break;
            case 'ARRAY_BUFFER':
                options.expectDataType = 2
                break;
        }
    }

    // è®¾ç½®ä¼˜å…ˆçº§
    if (utils.isNumber(config.priority)) {
        options.priority = config.priority;
    }
    // è®¾ç½®caPath
    if (config.caPath) {
        options.caPath = config.caPath;
    }
    // è®¾ç½®å®¢æˆ·ç«¯è¯ä¹¦
    if (!utils.isUndefined(config.clientCert)) {
        options.clientCert = config.clientCert;
        // keyPasswdè½¬æ¢ä¸ºkeyPassword
        let { keyPasswd: keyPassword, ...rest } = options.clientCert;
        let clientCert = { ...rest, keyPassword };
        // certTypeè½¬æ¢ä¸ºå¤§å°å­—ç¬¦
        let certType = clientCert.certType;
        clientCert.certType = certType ? certType.toUpperCase() : certType;
        options.clientCert = clientCert;
    }
    // è®¾ç½®ä»£ç†
    if (!utils.isUndefined(config.proxy)) {
        options.usingProxy = config.proxy;
    }
    return options;
}

export { setHttpConfig, setOptions, judgeMaxContentLength }ÂšÙ†D:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\http.jsÙŠD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\download.jsÙˆD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\upload.jsÙ} hvigor_ignore_D:_apps_deveco_devecostudio-windows-5.1.0.828_DevEco Studio_sdk_default_openharmony_ets_api_@ohos.file.fs.d.tsÙyD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\utils.jsÙ| hvigor_ignore_D:_apps_deveco_devecostudio-windows-5.1.0.828_DevEco Studio_sdk_default_openharmony_ets_api_@ohos.buffer.d.tsÙ~ hvigor_ignore_D:_apps_deveco_devecostudio-windows-5.1.0.828_DevEco Studio_sdk_default_openharmony_ets_api_@ohos.net.http.d.tsÙˆD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\env\classes\FormData.jsÙƒD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\core\AxiosError.jsÙ†D:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\core\buildFullPath.jsÙ‡D:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\index.jsÔrB˜±isLocalDependency¯isNodeEntryFile§pkgPath§pkgNameªpkgVersion±belongProjectPath±dependencyPkgInfo¨commonjsÂÂÙTD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios«@ohos/axios¥2.2.6ºD:\apps\deveco\tzb2025jbgsÔrC’§pkgNameªpkgVersion«@ohos/axios¥2.2.6ÔrD“°hasDefaultExport¯hasNamedExportsªisCommonJSÃÃÂÃÚ"é/*
 * The MIT License (MIT)
 * Copyright (C) 2023 Huawei Device Co., Ltd.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */

import http from './http.js'
import download from './download.js'
import upload from './upload.js'
import fs from '@ohos.file.fs';
import utils from '../../utils';
import buffer from '@ohos.buffer';
import _http from '@ohos.net.http';
import FormData from '../../env/classes/FormData.js'
import AxiosError from '../../../lib/core/AxiosError'
import buildFullPath from '../../../lib/core/buildFullPath';

const isXHRAdapterSupported = true
const part = '/data/storage/';

export default isXHRAdapterSupported && function (config) {
    return new Promise(function (resolve, reject) {
        const httpConfig = setHttpConfig(config, reject);
        if (config.data && config.data instanceof FormData && (config.method.toUpperCase() === 'POST' || config.method.toUpperCase() === 'PUT')) {
            // ä¸Šä¼ 
            upload(httpConfig, resolve, reject);
        } else if (config.filePath) {
            // ä¸‹è½½ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›é”™è¯¯ã€‚
            try {
                let path = '';
                let cacheDir = '';
                let filePath = config.filePath;
                if(config.context) {
                    cacheDir = config.context.cacheDir;
                    path = config.filePath.indexOf(cacheDir) > -1 ?  filePath : `${cacheDir}/${filePath}`;
                } else {
                    if(filePath.indexOf(part)===-1) {
                        return reject(new AxiosError('If there is no context, the filePath must be a complete fd path!', AxiosError.ERR_BAD_OPTION, null, null, null));
                    }
                }
                let res = fs.accessSync(path);
                if(!res){
                    download(httpConfig, resolve, reject);
                }else {
                    reject(new AxiosError('The file already exist, please delete the file first!', AxiosError.ERR_BAD_OPTION, null, null, null));
                }
            } catch (err) {
                reject(new AxiosError(err, AxiosError.ERR_BAD_OPTION, null, null, null));
            }
        } else {
            // å‘é€è¯·æ±‚
            http(httpConfig, resolve, reject);
        }
    })
}
/**
 * @param data éœ€è¦è®¡ç®—å­—èŠ‚çš„æ•°æ®
 */
const calculateLength = (data) => {
    let len = 0;
    if (data) {
        if (typeof data === 'string') {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥è®¡ç®—é•¿åº¦
            len = buffer.byteLength(data, 'utf8');
        } else if (buffer.isBuffer(data)) {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯Bufferå¯¹è±¡ï¼Œç›´æ¥è·å–é•¿åº¦
            len = data.length;
        } else if (data instanceof ArrayBuffer) {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯ArrayBufferå¯¹è±¡ï¼Œç›´æ¥è·å–é•¿åº¦
            len = data.byteLength;
        } else if (typeof data === 'number') {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯numberï¼Œç›´æ¥èµ‹å€¼
            len = data;
        }else {
            // å¯¹è±¡
            let tmp = data;
            if (utils.isFormData(data)) {
                function formDataToObject(formData) {
                    let object = {};
                    formData.forEach(function (value, key) {
                        object[key] = value;
                    });
                    return object;
                }
                tmp = formDataToObject(data);
            }
            // å¦‚æœè¯·æ±‚ä½“æ˜¯å¯¹è±¡ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²åè®¡ç®—é•¿åº¦
            len = buffer.byteLength(JSON.stringify(tmp), 'utf8');
        }
    }
    return len;
}
/**
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 */
const judgeMaxBodyLength = (config, reject) => {
    // è®¡ç®—è¯·æ±‚ä½“å¤§å°
    let requestBodyLength = calculateLength(config.data);
    if (config.maxBodyLength > -1 && requestBodyLength > config.maxBodyLength) {
        return reject(new AxiosError('Request body larger than maxBodyLength limit', AxiosError.ERR_BAD_REQUEST, config));
    }
}
/**
 * @param data å“åº”æ•°æ®
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 * @param lastRequest è¯·æ±‚å®ä¾‹
 * @param handle æ ¡éªŒåå›è°ƒ
 */
const judgeMaxContentLength = (data, config, reject, lastRequest, handle) => {
    // è®¡ç®—å“åº”å¤§å°
    let maxContentLength = calculateLength(data);
    let valid = true;
    if (config.maxContentLength > -1 && maxContentLength > config.maxContentLength) {
        valid = false;
    }
    handle&&handle(valid);
    // è¿”å›å†…å®¹å¤§äºconfig.maxContentLengthæŠ›å‡ºå¼‚å¸¸
    if(!valid) {
        return reject(new AxiosError(
            'maxContentLength size of ' + config.maxContentLength + ' exceeded',
            AxiosError.ERR_BAD_RESPONSE,
            config,
            lastRequest
        ));
    }
}
/**åˆ›å»ºè¯·æ±‚ä»»åŠ¡
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 */
const setHttpConfig = (config, reject) => {
    // æ¯ä¸€ä¸ªhttpRequestå¯¹åº”ä¸€ä¸ªhttpè¯·æ±‚ä»»åŠ¡ï¼Œä¸å¯å¤ç”¨
    let httpRequest = _http.createHttp();
    let fullPath = buildFullPath(config.baseURL, config.url);
    // urlæ ¡éªŒ
    if (!fullPath) {
        return reject(new AxiosError("Cannot read properties of url!", AxiosError.ERR_BAD_OPTION, config, null, null));
    } else if (typeof (fullPath) !== 'string') {
        return reject(new AxiosError("Url type should be character typeï¼", AxiosError.ERR_BAD_OPTION_VALUE, config, null, null));
    }
    // åˆ¤æ–­è®¾ç½®çš„è¯·æ±‚ä½“çš„å¤§å°
    judgeMaxBodyLength(config, reject);
    return {
        httpRequest,
        fullPath,
        config
    }
}
/**è®¾ç½®è¯·æ±‚è‡ªå®šä¹‰é…ç½®é¡¹
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param handle å¤„ç†optionsçš„å‡½æ•°
 */
const setOptions = (config, handle) => {
    let options = {
        method: config.method.toUpperCase(),
        header: config.headers, // å¼€å‘è€…æ ¹æ®è‡ªèº«ä¸šåŠ¡éœ€è¦æ·»åŠ headerå­—æ®µ
        readTimeout: 0,
        maxLimit: -1// é»˜è®¤æ”¾å¼€http requestçš„5MBé™åˆ¶ï¼Œåœ¨axioså±‚çš„maxBodyLengthè¿›è¡Œé•¿åº¦é™åˆ¶
    }
    handle && handle(options)
    // è®¾ç½®è¯·æ±‚ä½“
    if (!utils.isUndefined(config.data)) { // å½“ä½¿ç”¨POSTè¯·æ±‚æ—¶æ­¤å­—æ®µç”¨äºä¼ é€’å†…å®¹
        options.extraData = config.data;
    }
    // è®¾ç½®è¿æ¥è¶…æ—¶
    if (utils.isNumber(config.connectTimeout)) {
        options.connectTimeout = config.connectTimeout;
    }
    // è®¾ç½®è¯»å–è¶…æ—¶
    if (utils.isNumber(config.timeout)) {
        options.readTimeout = config.timeout;
    }
    // è®¾ç½®è¯»å–è¶…æ—¶
    if (utils.isNumber(config.readTimeout)) {
        options.readTimeout = config.readTimeout;
    }
    // è®¾ç½®å“åº”æ¶ˆæ¯çš„æœ€å¤§å­—èŠ‚
    if (utils.isNumber(config.maxContentLength)) {
        options.maxLimit = config.maxContentLength;
    }
    // è®¾ç½®responseType
    if (!utils.isUndefined(config.responseType)) {
        let responseType = config.responseType.toUpperCase()
        switch (responseType) {
            case 'STRING':
                options.expectDataType = 0
                break;
            case 'OBJECT':
                options.expectDataType = 1
                break;
            case 'ARRAY_BUFFER':
                options.expectDataType = 2
                break;
        }
    }

    // è®¾ç½®ä¼˜å…ˆçº§
    if (utils.isNumber(config.priority)) {
        options.priority = config.priority;
    }
    // è®¾ç½®caPath
    if (config.caPath) {
        options.caPath = config.caPath;
    }
    // è®¾ç½®å®¢æˆ·ç«¯è¯ä¹¦
    if (!utils.isUndefined(config.clientCert)) {
        options.clientCert = config.clientCert;
        // keyPasswdè½¬æ¢ä¸ºkeyPassword
        let { keyPasswd: keyPassword, ...rest } = options.clientCert;
        let clientCert = { ...rest, keyPassword };
        // certTypeè½¬æ¢ä¸ºå¤§å°å­—ç¬¦
        let certType = clientCert.certType;
        clientCert.certType = certType ? certType.toUpperCase() : certType;
        options.clientCert = clientCert;
    }
    // è®¾ç½®ä»£ç†
    if (!utils.isUndefined(config.proxy)) {
        options.usingProxy = config.proxy;
    }
    return options;
}

export { setHttpConfig, setOptions, judgeMaxContentLength }ÔrE•§version¨mappings¥names§sources®sourcesContentÜ ê‘”    ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”  	 ‘”  
 ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”   ‘”    ‘”  ! ‘”  " ‘”  # ‘”  $ ‘”  % ‘”  & ‘”  ' ‘”  ( ‘”  ) ‘”  * ‘”  + ‘”  , ‘”  - ‘”  . ‘”  / ‘”  0 ‘”  1 ‘”  2 ‘”  3 ‘”  4 ‘”  5 ‘”  6 ‘”  7 ‘”  8 ‘”  9 ‘”  : ‘”  ; ‘”  < ‘”  = ‘”  > ‘”  ? ‘”  Ì@ ‘”  ÌA ‘”  ÌB ‘”  ÌC ‘”  ÌD ‘”  ÌE ‘”  ÌF ‘”  ÌG ‘”  ÌH ‘”  ÌI ‘”  ÌJ ‘”  ÌK ‘”  ÌL ‘”  ÌM ‘”  ÌN ‘”  ÌO ‘”  ÌP ‘”  ÌQ ‘”  ÌR ‘”  ÌS ‘”  ÌT ‘”  ÌU ‘”  ÌV ‘”  ÌW ‘”  ÌX ‘”  ÌY ‘”  ÌZ ‘”  Ì[ ‘”  Ì\ ‘”  Ì] ‘”  Ì^ ‘”  Ì_ ‘”  Ì` ‘”  Ìa ‘”  Ìb ‘”  Ìc ‘”  Ìd ‘”  Ìe ‘”  Ìf ‘”  Ìg ‘”  Ìh ‘”  Ìi ‘”  Ìj ‘”  Ìk ‘”  Ìl ‘”  Ìm ‘”  Ìn ‘”  Ìo ‘”  Ìp ‘”  Ìq ‘”  Ìr ‘”  Ìs ‘”  Ìt ‘”  Ìu ‘”  Ìv ‘”  Ìw ‘”  Ìx ‘”  Ìy ‘”  Ìz ‘”  Ì{ ‘”  Ì| ‘”  Ì} ‘”  Ì~ ‘”  Ì ‘”  Ì€ ‘”  Ì ‘”  Ì‚ ‘”  Ìƒ ‘”  Ì„ ‘”  Ì… ‘”  Ì† ‘”  Ì‡ ‘”  Ìˆ ‘”  Ì‰ ‘”  ÌŠ ‘”  Ì‹ ‘”  ÌŒ ‘”  Ì ‘”  Ì ‘”  Ì ‘”  Ì ‘”  Ì‘ ‘”  Ì’ ‘”  Ì“ ‘”  Ì” ‘”  Ì• ‘”  Ì– ‘”  Ì— ‘”  Ì˜ ‘”  Ì™ ‘”  Ìš ‘”  Ì› ‘”  Ìœ ‘”  Ì ‘”  Ì ‘”  ÌŸ ‘”  Ì  ‘”  Ì¡ ‘”  Ì¢ ‘”  Ì£ ‘”  Ì¤ ‘”  Ì¥ ‘”  Ì¦ ‘”  Ì§ ‘”  Ì¨ ‘”  Ì© ‘”  Ìª ‘”  Ì« ‘”  Ì¬ ‘”  Ì­ ‘”  Ì® ‘”  Ì¯ ‘”  Ì° ‘”  Ì± ‘”  Ì² ‘”  Ì³ ‘”  Ì´ ‘”  Ìµ ‘”  Ì¶ ‘”  Ì· ‘”  Ì¸ ‘”  Ì¹ ‘”  Ìº ‘”  Ì» ‘”  Ì¼ ‘”  Ì½ ‘”  Ì¾ ‘”  Ì¿ ‘”  ÌÀ ‘”  ÌÁ ‘”  ÌÂ ‘”  ÌÃ ‘”  ÌÄ ‘”  ÌÅ ‘”  ÌÆ ‘”  ÌÇ ‘”  ÌÈ ‘”  ÌÉ ‘”  ÌÊ ‘”  ÌË ‘”  ÌÌ ‘”  ÌÍ ‘”  ÌÎ ‘”  ÌÏ ‘”  ÌĞ ‘”  ÌÑ ‘”  ÌÒ ‘”  ÌÓ ‘”  ÌÔ ‘”  ÌÕ ‘”  ÌÖ ‘”  Ì× ‘”  ÌØ ‘”  ÌÙ ‘”  ÌÚ ‘”  ÌÛ ‘”  ÌÜ ‘”  Ìİ ‘”  ÌŞ ‘”  Ìß ‘”  Ìà ‘”  Ìá ‘”  Ìâ ‘”  Ìã ‘”  Ìä ‘”  Ìå ‘”  Ìæ ‘”  Ìç ‘”  Ìè ‘”  Ìé ‘Ù‡D:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\index.js‘Ú"é/*
 * The MIT License (MIT)
 * Copyright (C) 2023 Huawei Device Co., Ltd.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */

import http from './http.js'
import download from './download.js'
import upload from './upload.js'
import fs from '@ohos.file.fs';
import utils from '../../utils';
import buffer from '@ohos.buffer';
import _http from '@ohos.net.http';
import FormData from '../../env/classes/FormData.js'
import AxiosError from '../../../lib/core/AxiosError'
import buildFullPath from '../../../lib/core/buildFullPath';

const isXHRAdapterSupported = true
const part = '/data/storage/';

export default isXHRAdapterSupported && function (config) {
    return new Promise(function (resolve, reject) {
        const httpConfig = setHttpConfig(config, reject);
        if (config.data && config.data instanceof FormData && (config.method.toUpperCase() === 'POST' || config.method.toUpperCase() === 'PUT')) {
            // ä¸Šä¼ 
            upload(httpConfig, resolve, reject);
        } else if (config.filePath) {
            // ä¸‹è½½ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›é”™è¯¯ã€‚
            try {
                let path = '';
                let cacheDir = '';
                let filePath = config.filePath;
                if(config.context) {
                    cacheDir = config.context.cacheDir;
                    path = config.filePath.indexOf(cacheDir) > -1 ?  filePath : `${cacheDir}/${filePath}`;
                } else {
                    if(filePath.indexOf(part)===-1) {
                        return reject(new AxiosError('If there is no context, the filePath must be a complete fd path!', AxiosError.ERR_BAD_OPTION, null, null, null));
                    }
                }
                let res = fs.accessSync(path);
                if(!res){
                    download(httpConfig, resolve, reject);
                }else {
                    reject(new AxiosError('The file already exist, please delete the file first!', AxiosError.ERR_BAD_OPTION, null, null, null));
                }
            } catch (err) {
                reject(new AxiosError(err, AxiosError.ERR_BAD_OPTION, null, null, null));
            }
        } else {
            // å‘é€è¯·æ±‚
            http(httpConfig, resolve, reject);
        }
    })
}
/**
 * @param data éœ€è¦è®¡ç®—å­—èŠ‚çš„æ•°æ®
 */
const calculateLength = (data) => {
    let len = 0;
    if (data) {
        if (typeof data === 'string') {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥è®¡ç®—é•¿åº¦
            len = buffer.byteLength(data, 'utf8');
        } else if (buffer.isBuffer(data)) {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯Bufferå¯¹è±¡ï¼Œç›´æ¥è·å–é•¿åº¦
            len = data.length;
        } else if (data instanceof ArrayBuffer) {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯ArrayBufferå¯¹è±¡ï¼Œç›´æ¥è·å–é•¿åº¦
            len = data.byteLength;
        } else if (typeof data === 'number') {
            // å¦‚æœè¯·æ±‚ä½“æ˜¯numberï¼Œç›´æ¥èµ‹å€¼
            len = data;
        }else {
            // å¯¹è±¡
            let tmp = data;
            if (utils.isFormData(data)) {
                function formDataToObject(formData) {
                    let object = {};
                    formData.forEach(function (value, key) {
                        object[key] = value;
                    });
                    return object;
                }
                tmp = formDataToObject(data);
            }
            // å¦‚æœè¯·æ±‚ä½“æ˜¯å¯¹è±¡ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²åè®¡ç®—é•¿åº¦
            len = buffer.byteLength(JSON.stringify(tmp), 'utf8');
        }
    }
    return len;
}
/**
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 */
const judgeMaxBodyLength = (config, reject) => {
    // è®¡ç®—è¯·æ±‚ä½“å¤§å°
    let requestBodyLength = calculateLength(config.data);
    if (config.maxBodyLength > -1 && requestBodyLength > config.maxBodyLength) {
        return reject(new AxiosError('Request body larger than maxBodyLength limit', AxiosError.ERR_BAD_REQUEST, config));
    }
}
/**
 * @param data å“åº”æ•°æ®
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 * @param lastRequest è¯·æ±‚å®ä¾‹
 * @param handle æ ¡éªŒåå›è°ƒ
 */
const judgeMaxContentLength = (data, config, reject, lastRequest, handle) => {
    // è®¡ç®—å“åº”å¤§å°
    let maxContentLength = calculateLength(data);
    let valid = true;
    if (config.maxContentLength > -1 && maxContentLength > config.maxContentLength) {
        valid = false;
    }
    handle&&handle(valid);
    // è¿”å›å†…å®¹å¤§äºconfig.maxContentLengthæŠ›å‡ºå¼‚å¸¸
    if(!valid) {
        return reject(new AxiosError(
            'maxContentLength size of ' + config.maxContentLength + ' exceeded',
            AxiosError.ERR_BAD_RESPONSE,
            config,
            lastRequest
        ));
    }
}
/**åˆ›å»ºè¯·æ±‚ä»»åŠ¡
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param reject å¤±è´¥å›è°ƒ
 */
const setHttpConfig = (config, reject) => {
    // æ¯ä¸€ä¸ªhttpRequestå¯¹åº”ä¸€ä¸ªhttpè¯·æ±‚ä»»åŠ¡ï¼Œä¸å¯å¤ç”¨
    let httpRequest = _http.createHttp();
    let fullPath = buildFullPath(config.baseURL, config.url);
    // urlæ ¡éªŒ
    if (!fullPath) {
        return reject(new AxiosError("Cannot read properties of url!", AxiosError.ERR_BAD_OPTION, config, null, null));
    } else if (typeof (fullPath) !== 'string') {
        return reject(new AxiosError("Url type should be character typeï¼", AxiosError.ERR_BAD_OPTION_VALUE, config, null, null));
    }
    // åˆ¤æ–­è®¾ç½®çš„è¯·æ±‚ä½“çš„å¤§å°
    judgeMaxBodyLength(config, reject);
    return {
        httpRequest,
        fullPath,
        config
    }
}
/**è®¾ç½®è¯·æ±‚è‡ªå®šä¹‰é…ç½®é¡¹
 * @param config è¯·æ±‚é…ç½®é¡¹
 * @param handle å¤„ç†optionsçš„å‡½æ•°
 */
const setOptions = (config, handle) => {
    let options = {
        method: config.method.toUpperCase(),
        header: config.headers, // å¼€å‘è€…æ ¹æ®è‡ªèº«ä¸šåŠ¡éœ€è¦æ·»åŠ headerå­—æ®µ
        readTimeout: 0,
        maxLimit: -1// é»˜è®¤æ”¾å¼€http requestçš„5MBé™åˆ¶ï¼Œåœ¨axioså±‚çš„maxBodyLengthè¿›è¡Œé•¿åº¦é™åˆ¶
    }
    handle && handle(options)
    // è®¾ç½®è¯·æ±‚ä½“
    if (!utils.isUndefined(config.data)) { // å½“ä½¿ç”¨POSTè¯·æ±‚æ—¶æ­¤å­—æ®µç”¨äºä¼ é€’å†…å®¹
        options.extraData = config.data;
    }
    // è®¾ç½®è¿æ¥è¶…æ—¶
    if (utils.isNumber(config.connectTimeout)) {
        options.connectTimeout = config.connectTimeout;
    }
    // è®¾ç½®è¯»å–è¶…æ—¶
    if (utils.isNumber(config.timeout)) {
        options.readTimeout = config.timeout;
    }
    // è®¾ç½®è¯»å–è¶…æ—¶
    if (utils.isNumber(config.readTimeout)) {
        options.readTimeout = config.readTimeout;
    }
    // è®¾ç½®å“åº”æ¶ˆæ¯çš„æœ€å¤§å­—èŠ‚
    if (utils.isNumber(config.maxContentLength)) {
        options.maxLimit = config.maxContentLength;
    }
    // è®¾ç½®responseType
    if (!utils.isUndefined(config.responseType)) {
        let responseType = config.responseType.toUpperCase()
        switch (responseType) {
            case 'STRING':
                options.expectDataType = 0
                break;
            case 'OBJECT':
                options.expectDataType = 1
                break;
            case 'ARRAY_BUFFER':
                options.expectDataType = 2
                break;
        }
    }

    // è®¾ç½®ä¼˜å…ˆçº§
    if (utils.isNumber(config.priority)) {
        options.priority = config.priority;
    }
    // è®¾ç½®caPath
    if (config.caPath) {
        options.caPath = config.caPath;
    }
    // è®¾ç½®å®¢æˆ·ç«¯è¯ä¹¦
    if (!utils.isUndefined(config.clientCert)) {
        options.clientCert = config.clientCert;
        // keyPasswdè½¬æ¢ä¸ºkeyPassword
        let { keyPasswd: keyPassword, ...rest } = options.clientCert;
        let clientCert = { ...rest, keyPassword };
        // certTypeè½¬æ¢ä¸ºå¤§å°å­—ç¬¦
        let certType = clientCert.certType;
        clientCert.certType = certType ? certType.toUpperCase() : certType;
        options.clientCert = clientCert;
    }
    // è®¾ç½®ä»£ç†
    if (!utils.isUndefined(config.proxy)) {
        options.usingProxy = config.proxy;
    }
    return options;
}

export { setHttpConfig, setOptions, judgeMaxContentLength }ÔrFš­@ohos.file.fs¬@ohos.buffer®@ohos.net.http«../../utils½../../env/classes/FormData.js¼../../../lib/core/AxiosError¿../../../lib/core/buildFullPath­./download.js«./upload.js©./http.jsÔrG—ªassertions¨external¢id¤meta±moduleSideEffectsªresolvedByµsyntheticNamedExportsAÃÙ} hvigor_ignore_D:_apps_deveco_devecostudio-windows-5.1.0.828_DevEco Studio_sdk_default_openharmony_ets_api_@ohos.file.fs.d.tsAÃªoh-resolveÂGAÃÙ| hvigor_ignore_D:_apps_deveco_devecostudio-windows-5.1.0.828_DevEco Studio_sdk_default_openharmony_ets_api_@ohos.buffer.d.tsAÃªoh-resolveÂGAÃÙ~ hvigor_ignore_D:_apps_deveco_devecostudio-windows-5.1.0.828_DevEco Studio_sdk_default_openharmony_ets_api_@ohos.net.http.d.tsAÃªoh-resolveÂGAÂÙyD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\utils.jsAÃªoh-resolveÂGAÂÙˆD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\env\classes\FormData.jsAÃªoh-resolveÂGAÂÙƒD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\core\AxiosError.jsAÃªoh-resolveÂGAÂÙ†D:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\core\buildFullPath.jsAÃªoh-resolveÂGAÂÙŠD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\download.jsAÃªoh-resolveÂGAÂÙˆD:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\upload.jsAÃªoh-resolveÂGAÂÙ†D:\apps\deveco\tzb2025jbgs\oh_modules\.ohpm\@ohos+axios@2.2.6\oh_modules\@ohos\axios\src\main\ets\components\lib\adapters\ohos\http.jsAÃªoh-resolveÂ‘ÔrH’§missing¦pluginÃ¦genAbcÂÔ  ÔrI”²dynamicImportCache¹exportAllDeclarationCache»exportNamedDeclarationCache«importCache‘ÔrJ–¤type¥start£end«declarationªspecifiers¦source¶ExportNamedDeclarationÍüÍ 7À“ÔrK•¤type¥start£end¥local¨exported¯ExportSpecifierÍ Í ÔrL”¤type¥start£end¤nameªIdentifierÍ Í ­setHttpConfigLªIdentifierÍ Í ­setHttpConfigK¯ExportSpecifierÍ Í LªIdentifierÍ Í ªsetOptionsLªIdentifierÍ Í ªsetOptionsK¯ExportSpecifierÍ  Í 5LªIdentifierÍ  Í 5µjudgeMaxContentLengthLªIdentifierÍ  Í 5µjudgeMaxContentLengthÀšÔrM•¤type¥start£endªspecifiers¦source±ImportDeclarationÍ¬ÍÈ‘ÔrN”¤type¥start£end¥local¶ImportDefaultSpecifierÍ³Í·LªIdentifierÍ³Í·¤httpÔrO•¤type¥start£end¥value£raw§LiteralÍ½ÍÈ©./http.js«'./http.js'M±ImportDeclarationÍÊÍî‘N¶ImportDefaultSpecifierÍÑÍÙLªIdentifierÍÑÍÙ¨downloadO§LiteralÍßÍî­./download.js¯'./download.js'M±ImportDeclarationÍğÍ‘N¶ImportDefaultSpecifierÍ÷ÍıLªIdentifierÍ÷Íı¦uploadO§LiteralÍÍ«./upload.js­'./upload.js'M±ImportDeclarationÍÍ1‘N¶ImportDefaultSpecifierÍÍLªIdentifierÍÍ¢fsO§LiteralÍ!Í0­@ohos.file.fs¯'@ohos.file.fs'M±ImportDeclarationÍ3ÍS‘N¶ImportDefaultSpecifierÍ:Í?LªIdentifierÍ:Í?¥utilsO§LiteralÍEÍR«../../utils­'../../utils'M±ImportDeclarationÍUÍw‘N¶ImportDefaultSpecifierÍ\ÍbLªIdentifierÍ\Íb¦bufferO§LiteralÍhÍv¬@ohos.buffer®'@ohos.buffer'M±ImportDeclarationÍyÍœ‘N¶ImportDefaultSpecifierÍ€Í…LªIdentifierÍ€Í…¥_httpO§LiteralÍ‹Í›®@ohos.net.http°'@ohos.net.http'M±ImportDeclarationÍÍÒ‘N¶ImportDefaultSpecifierÍ¥Í­LªIdentifierÍ¥Í­¨FormDataO§LiteralÍ³ÍÒ½../../env/classes/FormData.js¿'../../env/classes/FormData.js'M±ImportDeclarationÍÔÍ	‘N¶ImportDefaultSpecifierÍÛÍåLªIdentifierÍÛÍåªAxiosErrorO§LiteralÍëÍ	¼../../../lib/core/AxiosError¾'../../../lib/core/AxiosError'M±ImportDeclarationÍÍG‘N¶ImportDefaultSpecifierÍÍLªIdentifierÍÍ­buildFullPathO§LiteralÍ%ÍF¿../../../lib/core/buildFullPathÙ!'../../../lib/core/buildFullPath'